{"version":3,"file":"commonHelpers.js","sources":["../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\niziToast.settings({\n  position: 'topRight',\n  timeout: 3000,\n  close: false,\n});\n\nconst apiKey = '40910932-9fe08a71e8ac0f3a1299db850';\nconst searchForm = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nlet page = 1;\nlet currentSearchQuery = '';\nconst lightbox = new SimpleLightbox('.gallery a');\nlet hoorayDisplayed = false;\nlet allImagesLoaded = false;\nlet noMoreImagesToastDisplayed = false;\n\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  page = 1;\n  gallery.innerHTML = '';\n  const formData = new FormData(searchForm);\n  const searchQuery = formData.get('searchQuery');\n  currentSearchQuery = searchQuery.trim();\n  \n  hoorayDisplayed = false;\n  allImagesLoaded = false;\n  noMoreImagesToastDisplayed = false;\n\n  if (currentSearchQuery !== '') {\n    const data = await searchImages(currentSearchQuery);\n    handleImageData(data);\n  } else {\n    iziToast.info({\n      title: 'Info',\n      message: 'Please enter a search query.',\n    });\n  }\n});\n\nasync function searchImages(query) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: apiKey,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 40,\n    },\n  });\n\n  return response.data;\n}\n\nfunction handleImageData(data) {\n  if (data.hits.length === 0) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Sorry, there are no images matching your search query. Please try again.',\n    });\n  } else {\n    displayImages(data.hits);\n    if (!hoorayDisplayed) {\n      iziToast.success({\n        title: 'Success',\n        message: `Hooray! We found ${data.totalHits} images.`,\n      });\n      hoorayDisplayed = true;\n    }\n    lightbox.refresh();\n    page++;\n    if (data.hits.length < 40) {\n      allImagesLoaded = true;\n    }\n  }\n}\n\nfunction displayImages(images) {\n  let imagesHTML = '';\n\n  images.forEach((image) => {\n    const infoHTML = `\n      <div class=\"info\">\n        <p class=\"info-item\"><b>Likes:</b> ${image.likes}</p>\n        <p class=\"info-item\"><b>Views:</b> ${image.views}</p>\n        <p class=\"info-item\"><b>Comments:</b> ${image.comments}</p>\n        <p class=\"info-item\"><b>Downloads:</b> ${image.downloads}</p>\n      </div>\n    `;\n\n    const cardLink = `\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery-images\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n      </a>\n    `;\n\n    const card = `\n      <div class=\"photo-card\">\n        ${cardLink}\n        ${infoHTML}\n      </div>\n    `;\n\n    imagesHTML += card;\n  });\n\n  gallery.insertAdjacentHTML('beforeend', imagesHTML);\n}\n\nfunction checkScroll() {\n  const {\n    scrollTop,\n    clientHeight,\n    scrollHeight\n  } = document.documentElement;\n\n  if (scrollTop + clientHeight >= scrollHeight - 5) {\n    if (!allImagesLoaded && !noMoreImagesToastDisplayed) {\n      searchImages(currentSearchQuery).then((data) => {\n        handleImageData(data);\n      });\n    } else if (allImagesLoaded && !noMoreImagesToastDisplayed) {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load.',\n      });\n      noMoreImagesToastDisplayed = true;\n    }\n  }\n}\n\nwindow.addEventListener('scroll', checkScroll);"],"names":["iziToast","apiKey","searchForm","gallery","page","currentSearchQuery","lightbox","SimpleLightbox","hoorayDisplayed","allImagesLoaded","noMoreImagesToastDisplayed","event","data","searchImages","handleImageData","query","axios","displayImages","images","imagesHTML","image","infoHTML","card","checkScroll","scrollTop","clientHeight","scrollHeight"],"mappings":"+vBAMAA,EAAS,SAAS,CAChB,SAAU,WACV,QAAS,IACT,MAAO,EACT,CAAC,EAED,MAAMC,EAAS,qCACTC,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAAO,EACPC,EAAqB,GACzB,MAAMC,EAAW,IAAIC,EAAe,YAAY,EAChD,IAAIC,EAAkB,GAClBC,EAAkB,GAClBC,EAA6B,GAEjCR,EAAW,iBAAiB,SAAU,MAAOS,GAAU,CAYrD,GAXAA,EAAM,eAAc,EACpBP,EAAO,EACPD,EAAQ,UAAY,GAGpBE,EAFiB,IAAI,SAASH,CAAU,EACX,IAAI,aAAa,EACb,OAEjCM,EAAkB,GAClBC,EAAkB,GAClBC,EAA6B,GAEzBL,IAAuB,GAAI,CAC7B,MAAMO,EAAO,MAAMC,EAAaR,CAAkB,EAClDS,EAAgBF,CAAI,CACxB,MACIZ,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,8BACf,CAAK,CAEL,CAAC,EAED,eAAea,EAAaE,EAAO,CAajC,OAZiB,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKf,EACL,EAAGc,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMX,EACN,SAAU,EACX,CACL,CAAG,GAEe,IAClB,CAEA,SAASU,EAAgBF,EAAM,CACzBA,EAAK,KAAK,SAAW,EACvBZ,EAAS,MAAM,CACb,MAAO,QACP,QAAS,0EACf,CAAK,GAEDiB,EAAcL,EAAK,IAAI,EAClBJ,IACHR,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBY,EAAK,mBAC1C,CAAO,EACDJ,EAAkB,IAEpBF,EAAS,QAAO,EAChBF,IACIQ,EAAK,KAAK,OAAS,KACrBH,EAAkB,IAGxB,CAEA,SAASQ,EAAcC,EAAQ,CAC7B,IAAIC,EAAa,GAEjBD,EAAO,QAASE,GAAU,CACxB,MAAMC,EAAW;AAAA;AAAA,6CAEwBD,EAAM;AAAA,6CACNA,EAAM;AAAA,gDACHA,EAAM;AAAA,iDACLA,EAAM;AAAA;AAAA,MAU7CE,EAAO;AAAA;AAAA,UANI;AAAA,iBACJF,EAAM;AAAA,oBACHA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,UAO5CC;AAAA;AAAA,MAINF,GAAcG,CAClB,CAAG,EAEDnB,EAAQ,mBAAmB,YAAagB,CAAU,CACpD,CAEA,SAASI,GAAc,CACrB,KAAM,CACJ,UAAAC,EACA,aAAAC,EACA,aAAAC,CACJ,EAAM,SAAS,gBAETF,EAAYC,GAAgBC,EAAe,IACzC,CAACjB,GAAmB,CAACC,EACvBG,EAAaR,CAAkB,EAAE,KAAMO,GAAS,CAC9CE,EAAgBF,CAAI,CAC5B,CAAO,EACQH,GAAmB,CAACC,IAC7BV,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,yBACjB,CAAO,EACDU,EAA6B,IAGnC,CAEA,OAAO,iBAAiB,SAAUa,CAAW"}