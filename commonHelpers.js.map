{"version":3,"file":"commonHelpers.js","sources":["../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\niziToast.settings({\n  position: 'topRight',\n});\n\nconst apiKey = '40910932-9fe08a71e8ac0f3a1299db850';\nconst searchForm = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nlet page = 1;\nlet currentSearchQuery = '';\nconst lightbox = new SimpleLightbox('.gallery a');\nlet hoorayDisplayed = false; // Флаг для відстеження виведення повідомлення \"Hooray\"\n\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  page = 1;\n  gallery.innerHTML = '';\n  const formData = new FormData(searchForm);\n  const searchQuery = formData.get('searchQuery');\n  currentSearchQuery = searchQuery.trim();\n  await searchImages(currentSearchQuery);\n});\n\nasync function searchImages(query) {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: apiKey,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 40,\n      },\n    });\n\n    if (response.status === 200) {\n      const responseData = response.data;\n      if (\n        responseData &&\n        responseData.hits &&\n        Array.isArray(responseData.hits) &&\n        responseData.totalHits !== undefined\n      ) {\n        const images = responseData.hits;\n        const totalHits = responseData.totalHits;\n\n        if (images.length === 0) {\n          iziToast.error({\n            title: 'Error',\n            message: 'Sorry, there are no images matching your search query. Please try again.',\n          });\n        } else {\n          displayImages(images);\n          if (!hoorayDisplayed) {\n            iziToast.success({\n              title: 'Success',\n              message: `Hooray! We found ${totalHits} images.`,\n            });\n            hoorayDisplayed = true;\n          }\n          lightbox.refresh();\n          page++;\n        }\n      } else {\n        iziToast.error({\n          title: 'Error',\n          message: 'Response format is incorrect. Please try again.',\n        });\n      }\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message: 'Failed to fetch images. Please try again.',\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again.',\n    });\n  }\n}\n\nfunction displayImages(images) {\n  images.forEach((image) => {\n    const cardLink = document.createElement('a');\n    cardLink.href = image.largeImageURL;\n    cardLink.setAttribute('data-lightbox', 'gallery-images');\n\n    const card = document.createElement('div');\n    card.classList.add('photo-card');\n\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n    img.loading = 'lazy';\n    cardLink.appendChild(img);\n    card.appendChild(cardLink);\n\n    const info = document.createElement('div');\n    info.classList.add('info');\n\n    const likes = document.createElement('p');\n    likes.classList.add('info-item');\n    likes.innerHTML = `<b>Likes:</b> ${image.likes}`;\n    info.appendChild(likes);\n\n    const views = document.createElement('p');\n    views.classList.add('info-item');\n    views.innerHTML = `<b>Views:</b> ${image.views}`;\n    info.appendChild(views);\n\n    const comments = document.createElement('p');\n    comments.classList.add('info-item');\n    comments.innerHTML = `<b>Comments:</b> ${image.comments}`;\n    info.appendChild(comments);\n\n    const downloads = document.createElement('p');\n    downloads.classList.add('info-item');\n    downloads.innerHTML = `<b>Downloads:</b> ${image.downloads}`;\n    info.appendChild(downloads);\n\n    card.appendChild(info);\n    gallery.appendChild(card);\n  });\n}\n\nfunction checkScroll() {\n  const {\n    scrollTop,\n    clientHeight,\n    scrollHeight\n  } = document.documentElement;\n\n  if (scrollTop + clientHeight >= scrollHeight - 5) {\n    searchImages(currentSearchQuery);\n  }\n}\n\nwindow.addEventListener('scroll', checkScroll);"],"names":["iziToast","apiKey","searchForm","gallery","page","currentSearchQuery","lightbox","SimpleLightbox","hoorayDisplayed","event","searchImages","query","response","axios","responseData","images","totalHits","displayImages","error","image","cardLink","card","img","info","likes","views","comments","downloads","checkScroll","scrollTop","clientHeight","scrollHeight"],"mappings":"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"}